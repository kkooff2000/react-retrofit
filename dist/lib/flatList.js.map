{"version":3,"sources":["../../lib/flatList.js"],"names":["List","componentName","url","ListItem","config","_config","axiosConfig","API","data","api","_List","fetchData","undefined","ListWithAPI","fetchAPI","fetchNextAPI","target","name","descriptor","flatListProps","component","React","useState","res","setRes","refreshing","setRefresh","useEffect","then","length","item","index","toString","concat","indicator"],"mappings":"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","sourcesContent":["import axios, { AxiosRequestConfig } from 'axios'\nimport { FlatList, ActivityIndicator, FlatListProps } from 'react-native'\nimport React, { useEffect, useState } from 'react'\nimport { Get } from './retrofit'\n\n/**\n    * @param {React.Component} component\n    * @param {string} url\n    * @param {React.Component} listItem\n    * @param {RetrofitConfig} config\n    */\nexport const List = (componentName, url, ListItem, config) => {\n    const _config = { axiosConfig: {}, ...config }\n    class API {\n        @Get(url, _config.axiosConfig)\n        fetchData(data) {\n            return data\n        }\n    }\n    const api = new API()\n    return _List(api.fetchData, undefined, componentName, ListItem, config)\n}\n\n/**\n    * @param {React.Component} component\n    * @param {function name(data) {}} fetchAPI\n    * @param {function name(data) {}} fetchNextAPI\n    * @param {React.Component} listItem\n    * @param {RetrofitConfig} config\n    */\nexport const ListWithAPI = (componentName, fetchAPI, fetchNextAPI, ListItem, config) => {\n    return _List(fetchAPI, fetchNextAPI, componentName, ListItem, config)\n}\n\nconst _List = (fetchAPI, fetchNextAPI, componentName, ListItem, config) => (target, name, descriptor) => {\n    const _config = { axiosConfig: {}, flatListProps: {}, ...config }\n    const component = () => {\n        const [res, setRes] = React.useState([])\n        const [refreshing, setRefresh] = React.useState(false)\n        React.useEffect(() => {\n            fetchAPI().then(setRes)\n        }, [0])\n\n        return (\n            res !== undefined && res.length > 0 ?\n                <FlatList\n                    refreshing={refreshing}\n                    onRefresh={() => {\n                        setRefresh(true)\n                        fetchAPI().then(data => {\n                            setRefresh(false)\n                            setRes(data)\n                        })\n                    }}\n                    keyExtractor={(item, index) => index.toString()}\n                    data={res}\n                    renderItem={({ item }) => {\n                        return (<ListItem {...item} />)\n                    }}\n                    onEndReachedThreshold={0.1}\n                    onEndReached={() => {\n                        if (fetchNextAPI !== undefined) {\n                            setRefresh(true)\n                            fetchNextAPI().then(data => {\n                                setRefresh(false)\n                                setRes(res.concat(data))\n                            })\n                        }\n                    }}\n                    {..._config.flatListProps}\n                /> :\n                _config.indicator !== undefined ? _config.indicator :\n                    <ActivityIndicator size=\"large\" color=\"#CCC\" />\n        )\n    }\n    target[componentName] = component\n}\n\n\n/**\n * @typedef {Object} RetrofitConfig\n * @property {AxiosRequestConfig} axiosConfig\n * @property {FlatListProps} flatListProps\n * @property {React.Component} indicator\n */"],"file":"flatList.js"}